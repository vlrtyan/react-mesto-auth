{"ast":null,"code":"var _jsxFileName = \"/Users/vlrtyan/dev/react-mesto-auth/src/components/App.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { Route, Routes, useNavigate, useLocation } from 'react-router-dom';\nimport ProtectedRoute from './ProtectedRoute.js';\nimport Header from './Header.js';\nimport Main from './Main.js';\nimport Footer from './Footer.js';\nimport Login from './Login.js';\nimport Register from './Register.js';\nimport InfoTooltip from './InfoTooltip.js';\nimport ImagePopup from './ImagePopup.js';\nimport EditProfilePopup from './EditProfilePopup.js';\nimport EditAvatarPopup from './EditAvatarPopup.js';\nimport AddPlacePopup from './AddPlacePopup.js';\nimport CurrentUserContext from '../contexts/CurrentUserContext.js';\nimport { api } from '../utils/Api.js';\nimport * as auth from '../auth.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const [isEditAvatarPopupOpen, setEditAvatarPopupOpen] = React.useState(false);\n  const [isEditProfilePopupOpen, setEditProfilePopupOpen] = React.useState(false);\n  const [isAddPlacePopupOpen, setAddPlacePopupOpen] = React.useState(false);\n  const [isTooltipOpen, setTooltipOpen] = React.useState(false);\n  const [isTooltipSuccessful, setTooltipSuccessful] = React.useState(false);\n  const [selectedCard, setSelectedCard] = React.useState({});\n  const [cards, setCards] = React.useState([]);\n  const [loggedIn, setLoggedIn] = React.useState(false);\n  const navigate = useNavigate();\n  const location = useLocation();\n  const [currentUser, setCurrentUser] = React.useState({});\n  console.log(); //регистрация и авторизация\n\n  React.useEffect(() => {\n    if (localStorage.getItem('jwt')) {\n      const jwt = localStorage.getItem('jwt');\n      auth.checkToken(jwt).then(res => {\n        if (res) {\n          setLoggedIn(true);\n        }\n      });\n    }\n  }, []);\n  React.useEffect(() => {\n    if (loggedIn) {\n      navigate('/');\n    }\n  }, [loggedIn, navigate]);\n\n  const handleLogin = formData => {\n    auth.authorize(formData.email, formData.password).then(data => {\n      localStorage.setItem('jwt', data.jwt);\n      setLoggedIn(true);\n      navigate('/');\n    }).catch(err => {\n      console.log(err);\n      setTooltipSuccessful(false);\n      setTooltipOpen(true);\n    });\n  };\n\n  const handleRegistration = formData => {\n    auth.register(formData.email, formData.password).then(res => {\n      setTooltipSuccessful(true);\n      setTooltipOpen(true);\n      navigate('/sign-in');\n    }).catch(err => {\n      console.log(err);\n      setTooltipSuccessful(false);\n      setTooltipOpen(true);\n    });\n  };\n\n  const onLogout = () => {\n    setLoggedIn(false);\n    localStorage.removeItem('jwt');\n    navigate('/sign-in');\n  }; //отрисовка страницы\n\n\n  const handleEditAvatarClick = () => {\n    setEditAvatarPopupOpen(true);\n  };\n\n  const handleEditProfileClick = () => {\n    setEditProfilePopupOpen(true);\n  };\n\n  const handleAddPlaceClick = () => {\n    setAddPlacePopupOpen(true);\n  };\n\n  const handleCardClick = card => {\n    setSelectedCard(card);\n  };\n\n  const closeAllPopups = () => {\n    setEditAvatarPopupOpen(false);\n    setEditProfilePopupOpen(false);\n    setAddPlacePopupOpen(false);\n    setTooltipOpen(false);\n    setSelectedCard({});\n  };\n\n  const handleUpdateUser = _ref => {\n    let {\n      name,\n      about\n    } = _ref;\n    api.editUserData({\n      name,\n      about\n    }).then(res => {\n      setCurrentUser(res);\n      closeAllPopups();\n    }).catch(err => console.log(err));\n  };\n\n  const handleUpdateAvatar = _ref2 => {\n    let {\n      avatar\n    } = _ref2;\n    api.changeAvatar({\n      avatar\n    }).then(res => {\n      setCurrentUser(res);\n      closeAllPopups();\n    }).catch(err => console.log(err));\n  };\n\n  const handleCardLike = card => {\n    const isLiked = card.likes.some(like => like._id === currentUser._id); // отправить запрос в API и обновить данные карточки\n\n    api.changeLikeCardStatus(card, isLiked).then(newCard => {\n      setCards(state => state.map(c => c._id === card._id ? newCard : c));\n    }).catch(err => console.log(err));\n  };\n\n  const handleCardDelete = card => {\n    api.deleteCard(card).then(() => {\n      setCards(state => state.filter(c => c._id !== card._id));\n    }).catch(err => console.log(err));\n  };\n\n  const handleAddPlaceSubmit = newCard => {\n    api.addNewItem(newCard).then(newCard => {\n      setCards([newCard, ...cards]);\n      closeAllPopups();\n    }).catch(err => console.log(err));\n  };\n\n  React.useEffect(() => {\n    api.getUserData().then(userData => setCurrentUser(userData)).catch(err => console.log(err));\n  }, []);\n  React.useEffect(() => {\n    api.getInitialCards().then(res => {\n      setCards(res);\n    }).catch(err => console.log(err));\n  }, []);\n  return /*#__PURE__*/_jsxDEV(CurrentUserContext.Provider, {\n    value: currentUser,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"page\",\n      children: [/*#__PURE__*/_jsxDEV(Header, {\n        logout: loggedIn && onLogout,\n        userEmailInfo: \"mmmjhgjefgjegwfj\",\n        isLoggedIn: loggedIn,\n        url: location.pathname\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Routes, {\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          path: \"/\",\n          element: /*#__PURE__*/_jsxDEV(ProtectedRoute, {\n            loggedIn: loggedIn,\n            children: /*#__PURE__*/_jsxDEV(Main, {\n              cards: cards,\n              onEditAvatar: handleEditAvatarClick,\n              onEditProfile: handleEditProfileClick,\n              onAddPlace: handleAddPlaceClick,\n              onCardClick: handleCardClick,\n              onCardLike: handleCardLike,\n              onCardDelete: handleCardDelete\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 180,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/sign-in\",\n          element: /*#__PURE__*/_jsxDEV(Login, {\n            handleLogin: handleLogin\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 22\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/sign-up\",\n          element: /*#__PURE__*/_jsxDEV(Register, {\n            handleRegistration: handleRegistration\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 22\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(EditProfilePopup, {\n        isOpen: isEditProfilePopupOpen,\n        onClose: closeAllPopups,\n        onUpdateUser: handleUpdateUser\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(EditAvatarPopup, {\n        isOpen: isEditAvatarPopupOpen,\n        onClose: closeAllPopups,\n        onUpdateAvatar: handleUpdateAvatar\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(AddPlacePopup, {\n        isOpen: isAddPlacePopupOpen,\n        onClose: closeAllPopups,\n        onAddPlace: handleAddPlaceSubmit\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(InfoTooltip, {\n        isOpen: isTooltipOpen,\n        onClose: closeAllPopups,\n        isSuccessful: isTooltipSuccessful\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ImagePopup, {\n      card: selectedCard,\n      onClose: closeAllPopups\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 169,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"/AHKQ3gWW8PETNsb1Tsoauyc/TU=\", false, function () {\n  return [useNavigate, useLocation];\n});\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/vlrtyan/dev/react-mesto-auth/src/components/App.js"],"names":["React","Route","Routes","useNavigate","useLocation","ProtectedRoute","Header","Main","Footer","Login","Register","InfoTooltip","ImagePopup","EditProfilePopup","EditAvatarPopup","AddPlacePopup","CurrentUserContext","api","auth","App","isEditAvatarPopupOpen","setEditAvatarPopupOpen","useState","isEditProfilePopupOpen","setEditProfilePopupOpen","isAddPlacePopupOpen","setAddPlacePopupOpen","isTooltipOpen","setTooltipOpen","isTooltipSuccessful","setTooltipSuccessful","selectedCard","setSelectedCard","cards","setCards","loggedIn","setLoggedIn","navigate","location","currentUser","setCurrentUser","console","log","useEffect","localStorage","getItem","jwt","checkToken","then","res","handleLogin","formData","authorize","email","password","data","setItem","catch","err","handleRegistration","register","onLogout","removeItem","handleEditAvatarClick","handleEditProfileClick","handleAddPlaceClick","handleCardClick","card","closeAllPopups","handleUpdateUser","name","about","editUserData","handleUpdateAvatar","avatar","changeAvatar","handleCardLike","isLiked","likes","some","like","_id","changeLikeCardStatus","newCard","state","map","c","handleCardDelete","deleteCard","filter","handleAddPlaceSubmit","addNewItem","getUserData","userData","getInitialCards","pathname"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Route, Routes, useNavigate, useLocation } from 'react-router-dom';\nimport ProtectedRoute from './ProtectedRoute.js';\n\nimport Header from './Header.js';\nimport Main from './Main.js';\nimport Footer from './Footer.js';\nimport Login from './Login.js';\nimport Register from './Register.js';\nimport InfoTooltip from './InfoTooltip.js';\nimport ImagePopup from './ImagePopup.js';\nimport EditProfilePopup from './EditProfilePopup.js';\nimport EditAvatarPopup from './EditAvatarPopup.js';\nimport AddPlacePopup from './AddPlacePopup.js';\nimport CurrentUserContext from '../contexts/CurrentUserContext.js';\nimport { api } from '../utils/Api.js';\nimport * as auth from '../auth.js';\n\nfunction App() {\n  const [isEditAvatarPopupOpen, setEditAvatarPopupOpen] = React.useState(false);\n  const [isEditProfilePopupOpen, setEditProfilePopupOpen] = React.useState(false);\n  const [isAddPlacePopupOpen, setAddPlacePopupOpen] = React.useState(false);\n  const [isTooltipOpen, setTooltipOpen] = React.useState(false);\n  const [isTooltipSuccessful, setTooltipSuccessful] = React.useState(false);\n  const [selectedCard, setSelectedCard] = React.useState({});\n  const [cards, setCards] = React.useState([]);\n  const [loggedIn, setLoggedIn] = React.useState(false);\n  const navigate = useNavigate();\n  const location = useLocation();\n\n  const [currentUser, setCurrentUser] = React.useState({});\n\n  console.log()\n\n  //регистрация и авторизация\n\n  React.useEffect(() => {\n    if (localStorage.getItem('jwt')) {\n      const jwt = localStorage.getItem('jwt');\n      auth.checkToken(jwt)\n        .then((res) => {\n          if (res) {\n            setLoggedIn(true);\n          }\n        })\n    }\n  }, []);\n\n  React.useEffect(() => {\n    if (loggedIn) {\n      navigate('/');\n    }\n  }, [loggedIn, navigate])\n\n  const handleLogin = (formData) => {\n    auth.authorize(formData.email, formData.password)\n      .then((data) => {\n        localStorage.setItem('jwt', data.jwt);\n        setLoggedIn(true);\n        navigate('/');\n      })\n      .catch((err) => {\n        console.log(err);\n        setTooltipSuccessful(false);\n        setTooltipOpen(true);\n      });\n\n  }\n\n  const handleRegistration = (formData) => {\n    auth.register(formData.email, formData.password)\n      .then((res) => {\n        setTooltipSuccessful(true);\n        setTooltipOpen(true);\n        navigate('/sign-in');\n      })\n      .catch((err) => {\n        console.log(err);\n        setTooltipSuccessful(false);\n        setTooltipOpen(true);\n      });\n  }\n\n  const onLogout = () => {\n    setLoggedIn(false);\n    localStorage.removeItem('jwt');\n    navigate('/sign-in');\n  }\n\n  //отрисовка страницы\n  const handleEditAvatarClick = () => {\n    setEditAvatarPopupOpen(true);\n  }\n  const handleEditProfileClick = () => {\n    setEditProfilePopupOpen(true);\n  }\n  const handleAddPlaceClick = () => {\n    setAddPlacePopupOpen(true);\n  }\n  const handleCardClick = (card) => {\n    setSelectedCard(card);\n  }\n  const closeAllPopups = () => {\n    setEditAvatarPopupOpen(false);\n    setEditProfilePopupOpen(false);\n    setAddPlacePopupOpen(false);\n    setTooltipOpen(false);\n    setSelectedCard({});\n  }\n  const handleUpdateUser = ({ name, about }) => {\n    api.editUserData({ name, about })\n      .then((res) => {\n        setCurrentUser(res);\n        closeAllPopups();\n      })\n      .catch(err => console.log(err))\n  }\n  const handleUpdateAvatar = ({ avatar }) => {\n    api.changeAvatar({ avatar })\n      .then((res) => {\n        setCurrentUser(res);\n        closeAllPopups();\n      })\n      .catch(err => console.log(err))\n  }\n\n  const handleCardLike = (card) => {\n    const isLiked = card.likes.some(like => like._id === currentUser._id);\n    // отправить запрос в API и обновить данные карточки\n    api.changeLikeCardStatus(card, isLiked)\n      .then((newCard) => {\n        setCards((state) => state.map((c) => c._id === card._id ? newCard : c));\n      })\n      .catch(err => console.log(err));\n  }\n\n  const handleCardDelete = (card) => {\n    api.deleteCard(card)\n      .then(() => {\n        setCards((state) => state.filter((c) => c._id !== card._id));\n      })\n      .catch(err => console.log(err));\n  }\n\n  const handleAddPlaceSubmit = (newCard) => {\n    api.addNewItem(newCard)\n      .then((newCard) => {\n        setCards([newCard, ...cards])\n        closeAllPopups()\n      })\n      .catch(err => console.log(err))\n  }\n\n  React.useEffect(() => {\n    api.getUserData()\n      .then(userData => setCurrentUser(userData))\n      .catch(err => console.log(err))\n  }, [])\n\n  React.useEffect(() => {\n    api.getInitialCards()\n      .then((res) => {\n        setCards(res);\n      })\n      .catch((err) => console.log(err))\n  }, [])\n\n  return (\n    <CurrentUserContext.Provider value={currentUser}>\n      <div className='page'>\n        <Header\n          logout={loggedIn && onLogout}\n          userEmailInfo='mmmjhgjefgjegwfj'\n          isLoggedIn={loggedIn}\n          url={location.pathname}\n        />\n        <Routes>\n          <Route path='/' element={\n            <ProtectedRoute loggedIn={loggedIn}>\n              <Main\n                cards={cards}\n                onEditAvatar={handleEditAvatarClick}\n                onEditProfile={handleEditProfileClick}\n                onAddPlace={handleAddPlaceClick}\n                onCardClick={handleCardClick}\n                onCardLike={handleCardLike}\n                onCardDelete={handleCardDelete}\n              />\n            </ProtectedRoute>\n          } />\n          <Route\n            path='/sign-in'\n            element={<Login handleLogin={handleLogin} />} />\n          <Route\n            path='/sign-up'\n            element={<Register handleRegistration={handleRegistration} />} />\n        </Routes>\n        <Footer />\n\n\n        {/* попап редактирования профиля */}\n        <EditProfilePopup\n          isOpen={isEditProfilePopupOpen}\n          onClose={closeAllPopups}\n          onUpdateUser={handleUpdateUser}\n        />\n\n        {/* попап редактирования аватара */}\n        <EditAvatarPopup\n          isOpen={isEditAvatarPopupOpen}\n          onClose={closeAllPopups}\n          onUpdateAvatar={handleUpdateAvatar}\n        />\n\n        {/* попап добавления карточки */}\n        <AddPlacePopup\n          isOpen={isAddPlacePopupOpen}\n          onClose={closeAllPopups}\n          onAddPlace={handleAddPlaceSubmit}\n        />\n\n        <InfoTooltip\n          isOpen={isTooltipOpen}\n          onClose={closeAllPopups}\n          isSuccessful={isTooltipSuccessful}\n        />\n\n      </div>\n\n      <ImagePopup\n        card={selectedCard}\n        onClose={closeAllPopups}\n      />\n\n    </CurrentUserContext.Provider>\n  )\n}\n\nexport default App"]},"metadata":{},"sourceType":"module"}